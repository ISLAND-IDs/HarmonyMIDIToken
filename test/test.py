from HarmonyMIDIToken import HarmonyMIDIToken as Tokenizer
import json

MIDI = Tokenizer()
MIDI.set_id([128, 100, 10, 81, 3, 10, -1, 1, 10, 81, 2, 10, -1, 1, 10, 81, 1, 10, -1, 1, 10, 79, 2, 10, -1, 1, 10, 79, 2, 10, -1, 1, 10, 84, 1, 10, 84, 2, 10, -1, 2, 10, 84, 2, 10, 83, 1, 10, 84, 2, 10, 79, 1, 10, -1, 2, 10, 83, 2, 10, -1, 2, 10, 84, 3, 10, -1, 1, 10, 84, 2, 10, 83, 1, 10, 84, 2, 10, 79, 1, 10, -1, 2, 10, 83, 2, 10, -1, 2, 10, 81, 2, 10, -1, 2, 10, 81, 2, 10, 83, 1, 10, 84, 2, 10, 83, 2, 10, -1, 1, 10, 83, 2, 10, -1, 2, 10, 81, 3, 10, -1, 1, 10, 81, 2, 10, -1, 1, 10, 81, 1, 10, -1, 1, 10, 79, 2, 10, -1, 1, 10, 79, 2, 10, -1, 1, 10, 84, 1, 10, 84, 2, 10, -1, 2, 10, 84, 2, 10, 83, 1, 10, 84, 2, 10, 91, 1, 10, -1, 2, 10, 83, 2, 10, -1, 2, 10, 84, 3, 10, -1, 1, 10, 84, 2, 10, 83, 1, 10, 84, 2, 10, 91, 1, 10, -1, 2, 10, 83, 2, 10, -1, 2, 10, 81, 2, 10, -1, 2, 10, 81, 2, 10, 86, 1, 10, 84, 2, 10, 86, 2, 10, -1, 1, 10, 84, 2, 200, 20, 65, 1, 3, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 65, 1, 1, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 60, 8, 1, 20, 60, 8, 2, 20, -1, 2, 20, 60, 8, 2, 20, 60, 8, 1, 20, 60, 8, 2, 20, 60, 8, 1, 20, -1, 2, 20, 60, 8, 2, 20, -1, 2, 20, 69, 5, 3, 20, -1, 1, 20, 69, 5, 2, 20, 69, 5, 1, 20, 69, 5, 2, 20, 69, 5, 1, 20, -1, 2, 20, 69, 5, 2, 20, -1, 2, 20, 67, 1, 2, 20, -1, 2, 20, 67, 1, 2, 20, 67, 1, 1, 20, 67, 1, 2, 20, 67, 1, 2, 20, -1, 1, 20, 67, 1, 2, 20, -1, 2, 20, 65, 1, 3, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 65, 1, 1, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 65, 1, 2, 20, -1, 1, 20, 60, 8, 1, 20, 60, 8, 2, 20, -1, 2, 20, 60, 8, 2, 20, 60, 8, 1, 20, 60, 8, 2, 20, 60, 8, 1, 20, -1, 2, 20, 60, 8, 2, 20, -1, 2, 20, 69, 5, 3, 20, -1, 1, 20, 69, 5, 2, 20, 69, 5, 1, 20, 69, 5, 2, 20, 69, 5, 1, 20, -1, 2, 20, 69, 5, 2, 20, -1, 2, 20, 67, 1, 2, 20, -1, 2, 20, 67, 1, 2, 20, 67, 1, 1, 20, 67, 1, 2, 20, 67, 1, 2, 20, -1, 1, 20, 67, 1, 2, 300, 10, 53, 3, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 53, 1, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 55, 1, 10, 55, 2, 10, -1, 2, 10, 55, 2, 10, 55, 1, 10, 55, 2, 10, 55, 3, 10, 55, 2, 10, -1, -2, 10, 55, 2, 10, 48, 2, 10, 57, 3, 10, -1, 1, 10, 57, 2, 10, 57, 1, 10, 57, 2, 10, 57, 1, 10, -1, 2, 10, 57, 2, 10, 50, 2, 10, 55, 2, 10, -1, 2, 10, 55, 2, 10, 55, 1, 10, 55, 2, 10, 55, 2, 10, -1, 1, 10, 55, 2, 10, 48, 2, 10, 53, 3, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 53, 1, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 53, 2, 10, -1, 1, 10, 55, 1, 10, 55, 2, 10, -1, 2, 10, 55, 2, 10, 55, 1, 10, 55, 2, 10, 55, 3, 10, 55, 2, 10, -1, -2, 10, 55, 2, 10, 48, 2, 10, 57, 3, 10, -1, 1, 10, 57, 2, 10, 57, 1, 10, 57, 2, 10, 57, 1, 10, -1, 2, 10, 57, 2, 10, 50, 2, 10, 55, 2, 10, -1, 2, 10, 55, 2, 10, 55, 1, 10, 55, 2, 10, 55, 2, 10, -1, 1, 10, 55, 2, 10, 48, 2])
#MIDI.set_midi('test/test2.mid')

MIDI._midi = None  # Reset MIDI to None to test the generation of MIDI from stored values

print(MIDI.to_json())
with open('test/test.json', 'w') as f:
    dic = json.loads(MIDI.to_json())

    dic["Melody"] = dic["Melody"][:3]
    dic["Chord"] = dic["Chord"][:3]
    dic["Bass"] = dic["Bass"][:3] # 예시용 json이라 대충 자름

    f.write(json.dumps(dic))

midi= MIDI.to_midi() # This should generate MIDI from the stored melody and chords
midi.write('midi', fp='test/test_output.mid')  # Save the generated MIDI to a file

print(MIDI.token_id)  # Print the token ID to verify the output